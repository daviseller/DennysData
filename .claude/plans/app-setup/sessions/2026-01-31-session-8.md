# Session #8 Log

**Date:** 2026-01-31
**Plan:** app-setup

## Objective
Add player game log tab to the player profile panel

## Completed
- [x] Created `player_game_log` database table with game stats per player
- [x] Created `/api/player/[id]/gamelog` endpoint with season filtering
- [x] Added "Game Log" tab to PlayerPanel alongside "Career Stats"
- [x] Display individual game stats with date, opponent, result, and full stat line
- [x] Mark DNP games with muted styling and "DNP" label spanning stat columns
- [x] Fixed opponent_id parsing from API (home_team_id/visitor_team_id)
- [x] Added scrollable table body with sticky header
- [x] Season selector dropdown for switching between seasons
- [x] Added `dnp` and `started` columns to database (started not actively fetched)

## Not Completed
- [ ] Starter badge in game log - Removed due to performance (requires fetching lineups for each game)

## Decisions Made
| Decision | Rationale |
|----------|-----------|
| Cache game log in Supabase | Same pattern as player_season_stats - fetch once, serve from cache |
| Filter out 0-minute games | Initially filtered, then changed to show as DNP |
| Remove starter fetching | Too slow - requires lineups API call per game, not worth the latency |
| Keep started column in DB | Can populate later from box score views, just not proactively |

## Files Modified
- `src/lib/api.ts` - Added fetchPlayerGameLog function
- `src/lib/types.ts` - Added GameLogEntry and PlayerGameLogResponse types
- `src/lib/components/PlayerPanel.svelte` - Added tabs, game log table, DNP styling
- `src/routes/api/player/[id]/gamelog/+server.ts` - New endpoint (created)

## Database Migrations
- `create_player_game_log` - Main table with stats
- `add_dnp_to_player_game_log` - DNP boolean column
- `add_started_to_player_game_log` - Started boolean column

## Commits
- 0dac8e5: Add player game log tab with per-game stats

## Notes for Next Session
- Game log is functional with caching
- Consider adding game click to navigate to that game's box score
- Could add summary stats at top of game log (averages for filtered season)
